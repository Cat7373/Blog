<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 4.2.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="stylesheet" href="/css/main.css" integrity="sha512-rqHGaYAx08DY2DpoSM8qV+DGegk9RSZndriM5VSYTAvLnWYdL2N6oY86sn1AeAIybd8v8C60dIHZIsoDMsvdzw==" crossorigin="anonymous"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css" integrity="sha512-L7MWcK7FNPcwNqnLdZq86lTHYLdQqZaz5YcAgE+5cnGmlw8JT03QB2+oxL100UeB6RlzZLUxCGSS4/++mNZdxw==" crossorigin="anonymous"><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"blog.cat73.org",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}}}</script><meta name="description" content="前言眼馋搬瓦工的OpenVZ已久，今天终于把服务器折腾上了IPv6地址 顺便升级到了Ubuntu 18.10，把TLS1.3支持加上了"><meta property="og:type" content="article"><meta property="og:title" content="本站已支持 IPv6 和 TLS1.3"><meta property="og:url" content="https://blog.cat73.org/20180930/20180930.ipv6-tls13/index.html"><meta property="og:site_name" content="Cat73 Blog"><meta property="og:description" content="前言眼馋搬瓦工的OpenVZ已久，今天终于把服务器折腾上了IPv6地址 顺便升级到了Ubuntu 18.10，把TLS1.3支持加上了"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-09-30T15:31:00.000Z"><meta property="article:modified_time" content="2019-06-01T05:08:01.750Z"><meta property="article:author" content="Cat73"><meta property="article:tag" content="Nginx"><meta property="article:tag" content="水"><meta property="article:tag" content="IPv6"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://blog.cat73.org/20180930/20180930.ipv6-tls13/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>本站已支持 IPv6 和 TLS1.3 | Cat73 Blog</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">Cat73 Blog</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">喵星人占领地球战略指挥部</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i> 首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i> 分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i> 标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i> 关于</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i> 归档</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div> <a href="https://github.com/Cat7373" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener noreferrer" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://blog.cat73.org/20180930/20180930.ipv6-tls13/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/upload/headimg.jpg"><meta itemprop="name" content="Cat73"><meta itemprop="description" content="大家好窝萌是来统治蓝星人和汪星人的喵星人"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Cat73 Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> 本站已支持 IPv6 和 TLS1.3<a href="https://github.com/Cat7373/Blog/tree/src/source/_posts/20180930.ipv6-tls13.md" class="post-edit-link" title="编辑" rel="noopener noreferrer" target="_blank"><i class="fa fa-pencil-alt"></i></a></h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-09-30 23:31:00" itemprop="dateCreated datePublished" datetime="2018-09-30T23:31:00+08:00">2018-09-30</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2019-06-01 13:08:01" itemprop="dateModified" datetime="2019-06-01T13:08:01+08:00">2019-06-01</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%B0%B4/" itemprop="url" rel="index"><span itemprop="name">水</span></a></span></span></div></header><div class="post-body" itemprop="articleBody"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>眼馋搬瓦工的<code>OpenVZ</code>已久，今天终于把服务器折腾上了<code>IPv6</code>地址</p><p>顺便升级到了<code>Ubuntu 18.10</code>，把<code>TLS1.3</code>支持加上了</p><a id="more"></a><h2 id="OpenVZ-or-KVM"><a href="#OpenVZ-or-KVM" class="headerlink" title="OpenVZ or KVM"></a>OpenVZ or KVM</h2><p>之前买服务器的时候，看着搬瓦工有两种虚拟化方式可选，分别是<code>KVM</code>和<code>OpenVZ</code></p><p>当时还是小白的我并不懂这两种有什么区别，不过看到搬瓦工自己的介绍说：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">OpenVZ 拥有：</span><br><span class="line">IPv6 支持</span><br><span class="line">更好的 CPU 性能</span><br><span class="line"></span><br><span class="line">KVM 拥有：</span><br><span class="line">完整的虚拟化</span><br><span class="line">可自定义内核(如：BBR、支持 Docker)</span><br><span class="line">更好的隔离</span><br><span class="line">更好的网络性能</span><br></pre></td></tr></tbody></table></figure><p>当初的目的是买个服务器当梯子，来代替愈发难以连接的<code>GAE</code>，反正是买最低配的，<code>CPU</code>性能当然是没什么卵用，<code>IPv6</code>，emmm，天朝好像也不支持，似乎也没什么卵用，而且<code>KVM</code>可玩性高呀，可以上<code>BBR</code>，还有更好的网络性能，果断适合做梯子呀，于是当初就选择了<code>KVM</code>。</p><p>大概从今年初开始吧，看到国家哪哪又怎么推<code>IPv6</code>，一直感到很眼馋，一直想着再等等说不定运营商就把我这边的网络升级了呢？</p><p>直到我最近搞到了路由器的后台密码，进去瞅了一眼很绝望的发现，<code>TPLink</code>的路由器真是省成本省到家了，这货的固件压根就不支持<code>IPv6</code></p><p>好吧，感觉等是无望了，刚好本月出了点小失误，发现的时候已经晚了，服务器的流量还剩下不到<code>10GB</code>，于是向败个新的<code>OpenVZ</code>的服务器，一来顶一顶严重不足的流量，二来试试<code>IPv6</code>的感觉</p><p>嗯然后就开始查<code>IPv6</code>，突然发现原来<code>KVM</code>也可以通过隧道支持<code>IPv6</code>的，emmm 掰着指头数了数日子，剩下的流量省着点大概也能撑到重置，于是决定不买了，折腾一下试试吧</p><h2 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h2><p>照着网上一篇博客的教程，首先打开<a href="https://tunnelbroker.net" target="_blank" rel="noopener noreferrer">tunnelbroker</a>，注册账号，申请隧道，一切都很顺利，然后照着网站给的说明把配置填到<code>/etc/network/interfaces</code>里，嗯，一切顺利，只差重启</p><p>之后一个重启，执行<code>ifconfig</code>，看到了我的<code>IPv6</code>地址，嗯很舒服，然后就开始折腾<code>ss</code>看怎么能让我在自己的电脑上能访问<code>IPv6</code>的网站</p><p>折腾了一整晚，怎么弄怎么不通，最后很绝望的去睡了。。。</p><p>第二天，我试着在服务器上<code>ping</code>了下<code>google.com</code>，emmm，<code>ping</code>不通，<code>curl -6 google.com</code>也无法访问，直接 ping Google IPv6 的<code>IP</code>也不管用，emmm 好像是<code>IPv6</code>本身不通？</p><p>于是又折腾了一晚上，因为我也不大懂这个隧道的原理，所以也只能是去找各种博客，尝试各种配置，以及<code>tunnelbroker</code>上其他环境的配置方式，都尝试过了，一个管用的都没有，最后我把<code>IPv6</code>的配置一删，想着再也不折腾了，还是等着看什么时候搬瓦工原生支持<code>IPv6</code>吧，然后睡觉去了。。。</p><p>今晚闲着无聊，于是又回来试。。。最后发现，我就近选的洛杉矶节点的<code>IPv4</code>地址是可以<code>ping</code>通的，延迟在<code>1ms</code>以内，但<code>IPv6</code>的地址怎么也<code>ping</code>不通，换成纽约的节点之后，居然。。。就自己好了。。除了延迟高了点。。服务器上可以正常访问<code>IPv6</code>的站点，<code>ss</code>代理一点也没改，我本地直接就能访问<code>IPv6</code>的网站了。。真是坑。。。</p><p>然后又挨个节点试了试，选了一个延迟在<code>10ms</code>以下的节点，再改了下<code>Nginx</code>配置，加了<code>IPv6</code>的监听，于是本站正式支持<code>IPv6</code>了。。</p><h2 id="TLS1-3"><a href="#TLS1-3" class="headerlink" title="TLS1.3"></a>TLS1.3</h2><p>跟<code>IPv6</code>一样，<code>TLS1.3</code>我也等很久了，甚至等的比<code>IPv6</code>更久，之前看到<code>openssl 1.1.1</code>终于发正式版了，感觉很激动，<code>Ubuntu</code>官方源应该很快也会升级上来吧，然鹅稳定版就是稳定版，<code>18.04 LTS</code>就认死了发布时的<code>openssl 1.1.0</code></p><p>这两天顺便在<code>ppa</code>上看到<code>Ubuntu 18.10</code>开发版本的源已经升级到<code>openssl 1.1.1</code>了，于是把服务器升级到了这个开发版本，再稍微折腾了下，算是支持<code>TLS1.3</code>了</p><p>不过开发版本目前还是有坑的，<code>Nginx</code>不支持选择<code>TLS1.3</code>的<code>ciphers</code>，<code>OCSP Staple</code>似乎也挂了，等<code>18.10</code>正式发布应该会好些吧。。</p><p>由于主流浏览器尚未兼容，目前本站暂时维持支持<code>TLS1.2 + TLS1.3</code>，等主流浏览器的最新版都支持之后，将改为只保留<code>TLS1.3</code></p><p>到那个时候，大概又有新的东西可以折腾了吧。。。</p></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/Nginx/" rel="tag"># Nginx</a> <a href="/tags/%E6%B0%B4/" rel="tag"># 水</a> <a href="/tags/IPv6/" rel="tag"># IPv6</a></div><div class="post-nav"><div class="post-nav-item"><a href="/20180315/2018031501.wildcard/" rel="prev" title="本站已启用通配符证书"><i class="fa fa-chevron-left"></i> 本站已启用通配符证书</a></div><div class="post-nav-item"> <a href="/20190322/2019032201.20190501/" rel="next" title="2019 年五一调休方案">2019 年五一调休方案<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="gitalk-container"></div><script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span><span class="toggle-line toggle-line-middle"></span><span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OpenVZ-or-KVM"><span class="nav-number">2.</span> <span class="nav-text">OpenVZ or KVM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IPv6"><span class="nav-number">3.</span> <span class="nav-text">IPv6</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TLS1-3"><span class="nav-number">4.</span> <span class="nav-text">TLS1.3</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Cat73" src="/upload/headimg.jpg"><p class="site-author-name" itemprop="name">Cat73</p><div class="site-description" itemprop="description">大家好窝萌是来统治蓝星人和汪星人的喵星人</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">20</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/"><span class="site-state-item-count">12</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/"><span class="site-state-item-count">26</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Cat7373" title="Github → https://github.com/Cat7373" rel="noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i> Github</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://notes.jimliang.com/" title="http://notes.jimliang.com/" rel="noopener noreferrer" target="_blank">Jim's Notes</a></li><li class="links-of-blogroll-item"> <a href="https://www.locsian.com/" title="https://www.locsian.com" rel="noopener noreferrer" target="_blank">Locsian's Blog</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> © 2016 – <span itemprop="copyrightYear">2020</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Cat73</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener noreferrer" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener noreferrer" target="_blank">NexT.Gemini</a> 强力驱动</div></div></footer></div><script src="/lib/anime.min.js" integrity="sha512-PtERWMgvZ4H5VEu6gEcSap5qoi/OQksnTw+B4/0wyPrCe7Lbz1tl3piTtuNcOCV5OEXFFePqVTJW3h9Aacj2sA==" crossorigin="anonymous"></script><script src="/lib/velocity/velocity.min.js" integrity="sha512-r+WC4s/o+ePgGesrHDTOQpOHFMQH39icY2OUcaUU6SrFbi1keeuy3jHq8Q0SIuACtfZ7zRfPWYt0huP/guuU2w==" crossorigin="anonymous"></script><script src="/lib/velocity/velocity.ui.min.js" integrity="sha512-48rakD7aXAKjynjPfmdjgeHrLZcVimYHIq4hS4emn7MMLhfcpS5Mt4Mn3HeCr4vMGKUKgfoZ++ceCeR6UAKhWA==" crossorigin="anonymous"></script><script src="/js/utils.js" integrity="sha512-xlafgwhcUyEE7HKDpyNDzbdm7SXcIlSGFmOWE2dm+fd8ZRANLYNFJLFjWSEXt14bKbfWMsfx3ibJcljCQcCE2Q==" crossorigin="anonymous"></script><script src="/js/motion.js" integrity="sha512-aFZpRY3gmkyHYWIlJD7wZs2wzIAIqwSazgtis0Va5rGJZdj7QwXfYqdlb3LBARYJF4TTN0+O1BVAnJ6vTTob/A==" crossorigin="anonymous"></script><script src="/js/schemes/pisces.js" integrity="sha512-A2xN5D3dzTOGw6kMAcQxECrxdn/LqzrehzaNQvm1n/06t91TyvJ85eXkBhaV5XelEmMVEFYkGPaKtkGRm4YuPQ==" crossorigin="anonymous"></script><script src="/js/next-boot.js" integrity="sha512-zv9gPg6GY1OHOqhAqp2NTAf+UOMVCD++HCRqoKgfhhKi7R5Rsy7V13qKbd+ibbhkqYP5xQEvyW9L7W3hGw7juA==" crossorigin="anonymous"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css"><script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '7e893f940e4723d2af60',
      clientSecret: 'b5336eb0b13e2b09d26bc6f7fc84752c7c104db3',
      repo        : 'Blog',
      owner       : 'Cat7373',
      admin       : ['Cat7373'],
      id          : 'd824595172f19b84df6b10b129dfe831',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script></body></html>